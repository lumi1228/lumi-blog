import{_ as n,c as a,a as e,o as p}from"./app-gJ-WBVgF.js";const l={};function i(t,s){return p(),a("div",null,[...s[0]||(s[0]=[e(`<blockquote><p>官方文档参考：<a href="https://www.webpackjs.com/concepts/" target="_blank" rel="noopener noreferrer">webpack-中文网</a><br> 本案例参考当前项目内 demo：@/demo/webpack-demo<br> 开发环境：Node v20.18.3 / npm v10.8.2</p></blockquote><h3 id="安装与使用" tabindex="-1"><a class="header-anchor" href="#安装与使用"><span>安装与使用</span></a></h3><ul><li>初始化项目，生成 <code>package.json</code></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ cd webpack-demo</span>
<span class="line">$ npm init -y</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>安装 webpack（两种方式二选一）</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"># 方式一：项目本地安装</span>
<span class="line">$ npm install webpack webpack-cli -D</span>
<span class="line">$ ./node_modules/.bin/webpack --version  # 项目内查看版本</span>
<span class="line"></span>
<span class="line"># 方式二：全局安装</span>
<span class="line">$ npm install webpack webpack-cli -g</span>
<span class="line">$ webpack --version  # 全局查看版本</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在 <code>package.json</code> 配置脚本，通过 npm 调用 webpack</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/package.json"><span>@/package.json</span></div><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>执行打包</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm run build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="入口与输出" tabindex="-1"><a class="header-anchor" href="#入口与输出"><span>入口与输出</span></a></h3><ul><li>根目录创建 <code>index.js</code>（入口）与 <code>webpack.config.js</code>（配置）</li><li>未设置 <code>output</code> 时默认输出 <code>dist/main.js</code></li><li>自定义输出可指定文件名与路径，例如 <code>dist/bundle.js</code></li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 引入 path 模块</span></span>
<span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// console.log(path.resolve())</span></span>
<span class="line"><span class="token comment">// console.log(path.join(__dirname, &#39;./dist&#39;))</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;bundle.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./dist&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="loader、plugins" tabindex="-1"><a class="header-anchor" href="#loader、plugins"><span>loader、plugins</span></a></h3><h4 id="loader" tabindex="-1"><a class="header-anchor" href="#loader"><span>loader</span></a></h4><blockquote><p>webpack 原生只理解 JavaScript / JSON；loader 让它能处理样式、图片等更多资源。</p></blockquote><ul><li><p>核心属性：</p><ul><li><code>test</code>：匹配需要转换的文件</li><li><code>use</code>：声明转换所需的 loader 链</li></ul></li><li><p>主要特性：</p><ul><li>支持链式调用（执行顺序从右到左）</li><li>loader 可同步也可异步</li><li>运行在 Node.js 中，可执行任意 Node 功能</li></ul></li><li><p>安装示例所需 loader</p></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install css-loader style-loader sass-loader -D</span>
<span class="line">$ npm install url-loader file-loader -D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js -- 配置 scss、图片 loader"><span>@/webpack.config.js -- 配置 scss、图片 loader</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(.scss|.sass)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sass-loader&#39;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(jpe?g|png|gif|svg)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">          <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;url-loader&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 默认回退到 file-loader</span></span>
<span class="line">            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">              <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>        <span class="token comment">// &lt;10KB 转 base64</span></span>
<span class="line">              <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;[name].[ext]&#39;</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token literal-property property">outputPath</span><span class="token operator">:</span> <span class="token string">&#39;imgs/&#39;</span>  <span class="token comment">// 超出 limit 的资源输出目录</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h4 id="plugins" tabindex="-1"><a class="header-anchor" href="#plugins"><span>plugins</span></a></h4><blockquote><p>插件是 webpack 的支柱能力，用于完成 loader 无法覆盖的构建流程。</p></blockquote><ul><li>安装示例插件</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install html-webpack-plugin -D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js -- 配置 HtmlWebpackPlugin"><span>@/webpack.config.js -- 配置 HtmlWebpackPlugin</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span>   <span class="token comment">// dist 输出文件</span></span>
<span class="line">      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;template.html&#39;</span> <span class="token comment">// 根目录模板</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="hmr-hot-module-replacement" tabindex="-1"><a class="header-anchor" href="#hmr-hot-module-replacement"><span>HMR（Hot Module Replacement）</span></a></h3><h4 id="热编译-watch" tabindex="-1"><a class="header-anchor" href="#热编译-watch"><span>热编译（watch）</span></a></h4><blockquote><p><code>webpack --watch</code> 会监听文件变更并自动打包，但不会刷新浏览器。</p></blockquote><ul><li>在 <code>package.json</code> 添加脚本</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/package.json"><span>@/package.json</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>运行 <code>npm run watch</code>，文件保存后会自动重新打包</li></ul><h4 id="热更新-webpack-dev-server" tabindex="-1"><a class="header-anchor" href="#热更新-webpack-dev-server"><span>热更新（webpack-dev-server）</span></a></h4><ul><li>安装 dev server</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install webpack-dev-server -D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>配置脚本与 <code>devServer</code></li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/package.json"><span>@/package.json</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;hot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>运行 <code>npm run hot</code>，访问 <code>http://localhost:8080</code>，保存后即可自动编译并刷新</li></ul><h3 id="模式" tabindex="-1"><a class="header-anchor" href="#模式"><span>模式</span></a></h3><ul><li>webpack 提供 <code>development</code> / <code>production</code> 两种模式，可按需切换</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// production</span></span>
<span class="line"><span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// development</span></span>
<span class="line"><span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>结合 <code>process.env.NODE_ENV</code> 区分环境逻辑</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/index.js"><span>@/index.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;baseurl is localhost&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;baseurl is imooc.com&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="babel-配置" tabindex="-1"><a class="header-anchor" href="#babel-配置"><span>Babel 配置</span></a></h3><blockquote><p>Babel 将 ECMAScript 2015+ 转译为兼容旧浏览器的 JavaScript。</p></blockquote><ul><li>安装依赖</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install @babel/core babel-loader @babel/preset-env @babel/plugin-transform-runtime -D</span>
<span class="line">$ npm install @babel/runtime -S</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>创建 <code>.babelrc</code></li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/.babelrc"><span>@/.babelrc</span></div><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;@babel/preset-env&quot;</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>在 <code>webpack.config.js</code> 中启用 Babel</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="clean-webpack-plugin、copy-webpack-plugin" tabindex="-1"><a class="header-anchor" href="#clean-webpack-plugin、copy-webpack-plugin"><span>clean-webpack-plugin、copy-webpack-plugin</span></a></h3><blockquote><p><code>clean-webpack-plugin</code>：构建前清理输出目录<br><code>copy-webpack-plugin</code>：复制静态资源到输出目录</p></blockquote><ul><li>安装</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install clean-webpack-plugin copy-webpack-plugin -D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>配置</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;clean-webpack-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;copy-webpack-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">patterns</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">from</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;assets&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">&#39;assets&#39;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>打包后，<code>dist/assets</code> 会包含复制的静态资源</li></ul><h3 id="mini-css-extract-plugin、terser-webpack-plugin、css-minimizer-webpack-plugin" tabindex="-1"><a class="header-anchor" href="#mini-css-extract-plugin、terser-webpack-plugin、css-minimizer-webpack-plugin"><span>mini-css-extract-plugin、terser-webpack-plugin、css-minimizer-webpack-plugin</span></a></h3><blockquote><p><code>mini-css-extract-plugin</code>：抽离 CSS<br><code>terser-webpack-plugin</code>：压缩 JS<br><code>css-minimizer-webpack-plugin</code>：webpack 5 推荐的 CSS 压缩方案（替代 optimize-css-assets）</p></blockquote><ul><li>安装</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install -D mini-css-extract-plugin terser-webpack-plugin css-minimizer-webpack-plugin</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>配置</li></ul><div class="code-block-with-title"><div class="code-block-title-bar" data-title="@/webpack.config.js"><span>@/webpack.config.js</span></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;terser-webpack-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mini-css-extract-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;css-minimizer-webpack-plugin&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(.scss|.sass)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sass-loader&#39;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].css&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&#39;[id].css&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><ul><li>打包后，<code>dist</code> 中的 CSS 与 JS 均会被抽离并压缩</li></ul><h3 id="webpack5特性与迁移" tabindex="-1"><a class="header-anchor" href="#webpack5特性与迁移"><span>webpack5特性与迁移</span></a></h3><blockquote><p>官网文档参考： <a href="https://webpack.docschina.org/blog/2020-10-10-webpack-5-release/" target="_blank" rel="noopener noreferrer">webpack5介绍与新特性</a> 、<a href="https://webpack.docschina.org/migrate/5/" target="_blank" rel="noopener noreferrer">从V4迁移到V5</a></p></blockquote><h4 id="webpack5特性" tabindex="-1"><a class="header-anchor" href="#webpack5特性"><span>webpack5特性</span></a></h4><ul><li>尝试用持久性缓存来提高构建性能。</li><li>尝试用更好的算法和默认值来改进长期缓存。</li><li>尝试用更好的 Tree Shaking 和代码生成来改善包大小。</li><li>尝试改善与网络平台的兼容性。</li><li>尝试在不引入任何破坏性变化的情况下，清理那些在实现 v4 功能时处于奇怪状态的内部结构。</li><li>试图通过现在引入突破性的变化来为未来的功能做准备，使其能够尽可能长时间地保持在 v5 版本上。</li></ul><h4 id="构建时" tabindex="-1"><a class="header-anchor" href="#构建时"><span>构建时</span></a></h4><ul><li>内置<code>Assets-Modules</code>，静态资源构建能力，不需要像v4那样引入额外的loader进行处理</li><li>内置 <code>FileSystem Cache</code> 能力加速二次构建，v5 默认集成一种自带的缓存能力，</li><li>内置 <code>WebAssembly</code> 编译及<code>异步加载</code>能力 <ul><li>WebAssembly 是一种面向 web 的二进制的格式文件，因其更接近于机器码而拥有着更小的文件体积和更快速的执行效率。c/c++ 等高级语言都能直接编译成 .wasm 文件而被 js 调用。</li><li>Webpack5 拓展了 WebAssembly 的异步加载能力，使得我们可以更灵活地借助 WebAssembly 做更多有趣的事情。</li></ul></li><li>内置 <code>Web Worker</code> 构建能力</li></ul><h4 id="运行时" tabindex="-1"><a class="header-anchor" href="#运行时"><span>运行时</span></a></h4><ul><li>移除 <code>Node.js Polyfills</code>, <ul><li>如果前端包里使用了 process、path 这些依赖，需要手动添加 Polyfill 支持</li></ul></li><li>资源打包策略更优，构建产物更轻量 <ul><li>v5 内置了 Prepack 的部分能力，能够在原来的基础上再度优化项目构建产物的体积。</li></ul></li><li>深度 Tree Shaking 能力支持 <ul><li>指能够在打包的过程中移除 JavaScript 上下文中未被引用到的变量，借以次来减少打包后的体积。</li></ul></li><li>更友好的长期缓存支持性 <ul><li>Webpack5 之前，文件打包后的名称是通过id顺序排列的，一旦后续有一个文件进行了改动，那么必将造成后面的文件打包出来的文件名产生变化，即使文件内容没有产生改变。因此会造成资源的缓存失效。</li><li>Webpack5 有着更友好的长期缓存能力支持，其通过 hash 生成算法，为打包后的 modules 和 chunks 计算出一个短的数字 ID ，这样即使中间删除了某一个文件，也不会造成大量的文件缓存失效。</li></ul></li><li>支持 Top Level Await，从此告别 async <ul><li>运行开发者在 async 函数外部使用 await 字段</li></ul></li></ul>`,72)])])}const o=n(l,[["render",i]]),r=JSON.parse('{"path":"/fullstack/L1/03.tool-webpack.html","title":"工程化之打包工具 webpack","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"工程化之打包工具 webpack","description":"项目需求分析：从业务需求到技术选型的全流程实践"},"git":{"updatedTime":1763568531000,"contributors":[{"name":"lousm","username":"lousm","email":"lousm@yiche.com","commits":6,"url":"https://github.com/lousm"}],"changelog":[{"hash":"340f8dea52a1b79eb4329c786ed9d767c6694de1","time":1763568531000,"email":"lousm@yiche.com","author":"lousm","message":"demo &#x26; doc: koa up"},{"hash":"64e8eef120cabac29879ed54ff6753509cebf342","time":1763517555000,"email":"lousm@yiche.com","author":"lousm","message":"redirect：demo"},{"hash":"4c4498f44370c7b532d5193094640cbbf90ec4e8","time":1763451166000,"email":"lousm@yiche.com","author":"lousm","message":"docs: up"},{"hash":"002951946c745db80e68f4e74b7ec0196c827252","time":1763451080000,"email":"lousm@yiche.com","author":"lousm","message":"docs：up"},{"hash":"f36371c21251f226510a4e4be797c137768d7b7d","time":1763378252000,"email":"lousm@yiche.com","author":"lousm","message":"demo：webpack demo user"},{"hash":"9f168445b9c38bb53a503cacadc1989d03018f27","time":1763125545000,"email":"lousm@yiche.com","author":"lousm","message":"doc &#x26; webpack demo"}]},"filePathRelative":"fullstack/L1/03.tool-webpack.md"}');export{o as comp,r as data};
